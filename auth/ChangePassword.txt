title Thay đổi mật khẩu

actor Actor
participant Mobile Application
participant Server
database Database

activate Actor
activate Mobile Application
activate Server

Actor->Mobile Application:1: Open Profile Screen
Mobile Application-->>Actor:2: ProfileScreen()

Actor->Mobile Application:3: Change password
Mobile Application-->>Actor:4: ChangePasswordScreen()

loop New Password Invalid
Actor->Mobile Application:5: Input new password
Mobile Application->Mobile Application:6: ValidateNewPassword()
Mobile Application-->>Actor: 7: newPasswordInvalid()
end

Mobile Application->Server:8: PUT /api/users/{userId}/change-password

alt Normal
Server->Database:9: validatePassword()
activate Database
Database-->>Server:10: Result
deactivate Database

alt Validate Success
Server->>Database:11: updatePassword()
activate Database
Database-->>Server:12: Result
deactivate Database

Server-->>Mobile Application:13: message: "Thay đổi mật khẩu thành công."
else Validate Failure
Server-->>Mobile Application:14: error: "Mật khẩu hiện tại không chính xác."


end

else ServerError
Server-->>Mobile Application:15: error: "Đã xảy ra lỗi. Vui lòng thử lại sau."
end

Mobile Application-->>Actor:16: showMessage()